(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{27:function(e,a,t){e.exports=t(40)},38:function(e,a,t){},40:function(e,a,t){"use strict";t.r(a);var n=t(2),l=t(20),r=t.n(l),i=t(0),c=t.n(i),s=t(11),o=t(4),m=t(10),u=t.n(m),d=t(13);function f(e){return E.apply(this,arguments)}function E(){return(E=Object(d.a)(u.a.mark(function e(a){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,t){fetch(a,{method:"GET",headers:{"Content-Type":"application/json",credentials:"include"}}).then(function(e){return e.json()}).then(function(a){return e(a)}).catch(console.log)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function p(){return(p=Object(d.a)(u.a.mark(function e(a,t){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){fetch(a,{method:"POST",headers:{"Content-Type":"application/json",credentials:"include"},body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(a){return e(a)}).catch(console.log)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var v=t(6),h=t(25),g=t(26);function b(e){var a=Object(i.useState)(""),t=Object(n.a)(a,2),l=t[0],r=t[1],s=Object(i.useState)(""),o=Object(n.a)(s,2),m=o[0],u=o[1];function d(a){var t=[],n=!0,l=!1,i=void 0;try{for(var c,s=a[Symbol.iterator]();!(n=(c=s.next()).done);n=!0){var o=c.value;"image/jpeg"===o.type?(t.push(o),u(!0)):r("flash-red")}}catch(h){l=!0,i=h}finally{try{n||null==s.return||s.return()}finally{if(l)throw i}}if(t.length){for(var m=new FormData,d=0,f=t;d<f.length;d++){var E=f[d];m.append("file",E)}var p=new XMLHttpRequest,v="/api/image/"+e.id+"/"+(e.imageId+1);p.open("POST",v,!0),p.onload=function(a){u(!1),e.onChange(e.imageId+1)},p.send(m)}}function f(){r("")}return c.a.createElement("div",{className:"fileDrop "+l,onDragOver:function(e){e.preventDefault(),r("dragover")},onDrop:function(e){e.preventDefault(),f();var a=[];if(e.dataTransfer.items)for(var t=0;t<e.dataTransfer.items.length;t++)"file"===e.dataTransfer.items[t].kind&&a.push(e.dataTransfer.items[t].getAsFile());else for(t=0;t<e.dataTransfer.files.length;t++)a.push(e.dataTransfer.files[t]);a.length&&d(a)},onDragLeave:f},c.a.createElement("input",{id:"fileInput",type:"file",className:"hidden",onChange:function(e){r(!1),d(e.target.files)}}),c.a.createElement("div",{className:"uploadbox",onClick:function(e){e.preventDefault(),r(!0),document.getElementById("fileInput").click()}},m?c.a.createElement("i",{className:"fa fa-spinner fa-pulse fa-3x fa-fw"}):c.a.createElement("i",{className:"fa fa-upload"}),e.children))}function N(e){var a=e.person,t=e.edit;if(!a)return null;var l=Object(i.useState)(a),r=Object(n.a)(l,2),s=r[0],o=r[1];function m(){t(null)}function u(e){var a=e.target.label||e.target.getAttribute("label"),t=e.target.value;s[a]=t,o(Object(g.a)({},s))}return c.a.createElement("div",{className:"modal is-active"},c.a.createElement("div",{className:"modal-background",onClick:m}),c.a.createElement("div",{className:"modal-content"},c.a.createElement("section",{className:"edit"},c.a.createElement("div",{className:"edit-body"},c.a.createElement("div",{className:"columns is-vcentered is-mobile"},c.a.createElement("div",{className:"column is-narrow"},c.a.createElement(j,{id:s.id,name:s.name,imageId:s.imageId,onChange:u})),c.a.createElement("div",{className:"column"},c.a.createElement(y,{label:"id",value:s.id,onChange:u,disabled:!0}),c.a.createElement(y,{label:"name",value:s.name,onChange:u}),c.a.createElement(y,{label:"location",value:s.location,onChange:u}))),c.a.createElement(C,{dates:s.dates,onChange:u}),c.a.createElement(x,{contacts:s.emails,onChange:u}),c.a.createElement("div",{className:"buttons is-right padded"},c.a.createElement("button",{className:"button is-primary",onClick:function(){console.log(s),t(s),function(e,a){p.apply(this,arguments)}("/api/person",s),m()}},"Save"),c.a.createElement("button",{className:"button ",onClick:m},"Discard")))),c.a.createElement("button",{className:"modal-close is-large","aria-label":"close",onClick:m})))}function y(e){var a=e.label,t=e.value,n=e.onChange,l=e.disabled;return c.a.createElement("div",{className:"field is-horizontal"},c.a.createElement("div",{className:"field-label is-normal"},c.a.createElement("label",{className:"label"},a)),c.a.createElement("div",{className:"field-body"},c.a.createElement("div",{className:"field"},c.a.createElement("p",{className:"control"},c.a.createElement("input",{className:"input is-small",type:"text",label:a,placeholder:a,value:t,onChange:n,disabled:l?"disabled":""})))))}function C(e){var a=e.dates,t=e.onChange;function n(e){var n=e.name,l=e.id,r=e.value;null===r&&null===n?a.splice(l,1):a[l][n]=r,t({target:{label:"dates",value:Object(h.a)(a)}})}return c.a.createElement("div",{className:"list-editor"},c.a.createElement("div",{className:"list-title"},c.a.createElement("strong",null,"Dates")),c.a.createElement("div",{className:"list-items"},a&&a.length?a.map(function(e,a){return c.a.createElement(w,{date:e.date,description:e.description,onChange:n,id:a,key:"date"+a})}):null,c.a.createElement("div",{className:"buttons is-left"},c.a.createElement("button",{className:"button is-small is-success",onClick:function(){a||(a=[]),a.push({description:"",date:""}),n({id:a.length-1,name:"description",value:""})}},c.a.createElement("i",{className:"fa fa-plus"})))))}function w(e){var a=e.description,t=e.date,n=e.id,l=e.onChange;function r(e){l({id:n,name:e.target.name,value:e.target.value})}return c.a.createElement("div",{className:"person-date field is-horizontal"},c.a.createElement("div",{className:"field-body"},c.a.createElement("div",{className:"field"},c.a.createElement("p",{className:"control has-icons-left"},c.a.createElement("input",{className:"input is-small",value:a,name:"description",placeholder:"description",onChange:r}),c.a.createElement("span",{className:"icon is-small is-left"},c.a.createElement("i",{className:"fa fa-info"})))),c.a.createElement("div",{className:"field"},c.a.createElement("p",{className:"control has-icons-left"},c.a.createElement("input",{className:"input is-small",value:v(t).format("YYYY-MM-DD"),name:"date",type:"date",onChange:r}),c.a.createElement("span",{className:"icon is-small is-left"},c.a.createElement("i",{className:"fas fa-calendar"})))),c.a.createElement("div",{className:"field"},c.a.createElement("p",{className:"control "},c.a.createElement("button",{className:"button is-small",onClick:function(){l({id:n,name:null,value:null})}},c.a.createElement("i",{className:"fa fa-trash"}))))))}function j(e){var a=Object(i.useState)("/images/"+e.id+"_"+e.imageId+".jpg"),t=Object(n.a)(a,2),l=t[0],r=t[1];return c.a.createElement(b,{id:e.id,imageId:e.imageId,onChange:function(a){r("/images/"+e.id+"_"+a+".jpg"),e.onChange({target:{label:"imageId",value:a}})}},c.a.createElement("div",{className:"edit-image"},c.a.createElement("img",{src:l,alt:e.name})))}function x(e){var a=e.contacts,t=e.onChange;function n(e){var n=e.id,l=e.contact;null===l?a.splice(n,1):a[n]=l,t({target:{label:"emails",value:a}})}return c.a.createElement("div",{className:"list-editor"},c.a.createElement("div",{className:"list-title"},c.a.createElement("strong",null,"Contact Info")),c.a.createElement("div",{className:"list-items"},a&&a.length?a.map(function(e,a){return c.a.createElement(k,{contact:e,id:a,onChange:n,key:"contact"+a})}):null,c.a.createElement("div",{className:"buttons is-left"},c.a.createElement("button",{className:"button is-small is-success",onClick:function(){a||(a=[]),n({id:a.length,contact:""})}},c.a.createElement("i",{className:"fa fa-plus"})))))}function k(e){var a=e.contact,t=e.id,n=e.onChange;return c.a.createElement("div",{className:"field"},c.a.createElement("div",{className:"field-body"},c.a.createElement("div",{className:"field"},c.a.createElement("p",{className:"control has-icons-left"},c.a.createElement("input",{className:"input is-small",type:"email",value:a,placeholder:"email",onChange:function(e){n({id:t,contact:e.target.value})}}),c.a.createElement("span",{className:"icon is-small is-left"},c.a.createElement("i",{className:"fa fa-envelope"})))),c.a.createElement("div",{className:"field"},c.a.createElement("p",{className:"control "},c.a.createElement("button",{className:"button is-small",onClick:function(){n({id:t,contact:null})}},c.a.createElement("i",{className:"fa fa-trash"}))))))}var O=Number(function(e){var a=document.cookie.match("(^|[^;]+)\\s*"+e+"\\s*=\\s*([^;]+)");return a?a.pop():""}("level"));function S(e){var a=function(e){for(var a in e){for(var t=0,n=0,l=0,r=e[a].id,i=Number(a)+1;i<e.length;i++){var c=e[i].id;Math.floor(c/10)===r?t++:Math.floor(c/100)===r?n++:Math.floor(c/1e3)===r&&l++}e[a].childCount=[t,n,l]}return e}(e.family),t=Object(i.useState)(null),l=Object(n.a)(t,2),r=l[0],s=l[1];return c.a.createElement("div",{className:"directory"},a.map(function(a){return c.a.createElement(D,{person:a,key:a.id,forceExpand:e.forceExpand,edit:s})}),c.a.createElement(N,{person:r,edit:function(t){if(null===t)s(null);else{var n=a.findIndex(function(e){return e.id===t.id});-1===n?window.location.reload():(a[n]=t,e.setFamily(a))}}}))}function D(e){var a=e.person,t=e.forceExpand,l=e.edit,r=(e.nextChild,Object(i.useState)(t)),s=Object(n.a)(r,2),o=s[0],m=s[1],u=Object(i.useState)(t),d=Object(n.a)(u,2),f=d[0],E=d[1];t!==f&&(m(t),E(t));return c.a.createElement("section",{className:"person "+M(a.id)+(a.blur?" blur":""),id:a.id},c.a.createElement("div",{className:"person-title",onClick:function(){m(!o)}},c.a.createElement("span",null,c.a.createElement(I,{expanded:o})," \xa0",a.name),c.a.createElement(B,{childCount:a.childCount})),o?c.a.createElement("div",{className:"person-body"},c.a.createElement(L,{id:a.id,name:a.name,imageId:a.imageId}),c.a.createElement("div",{className:"person-details"},c.a.createElement(T,{location:a.location}),c.a.createElement("div",{className:"person-dates"},a.dates.map(function(e){return c.a.createElement(F,{date:e,key:e.date})})),c.a.createElement(Y,{emails:a.emails})),function(e,a){for(;e>0;){if(a===e)return!0;e=Math.floor(e/10)}return!1}(a.id,O)?c.a.createElement("div",{className:"buttons is-right padded"},c.a.createElement("button",{className:"button is-small editButton",onClick:function(){return l(a)}},c.a.createElement("i",{className:"fa fa-user-edit"})),c.a.createElement("button",{className:"button is-small editButton",onClick:function(){var e={id:Number(a.id+String(a.childCount[0]+1)),imageId:0,name:"",location:"",dates:[]};l(e)}},c.a.createElement("i",{className:"fa fa-user-plus"}))):null):null)}function I(e){return e.expanded?c.a.createElement("i",{className:"fa fa-caret-down"}):c.a.createElement("i",{className:"fa fa-caret-right"})}function M(e){return 1===e?"gen-0":e<19?"gen-1":e<199?"gen-2":e<1999?"gen-3":e<1999?"gen-4":void 0}function T(e){return e.location?c.a.createElement("div",{className:"person-location"},c.a.createElement("i",{title:"Current Location",className:"fa fa-map-marker-alt"})," \xa0",c.a.createElement("a",{href:"https://google.com/maps/search/"+e.location},e.location)):null}function L(e){return c.a.createElement("div",{className:"person-image"},c.a.createElement("img",{src:"/images/".concat(e.id,"_").concat(e.imageId||"0",".jpg"),alt:e.name}))}function Y(e){return e.emails&&e.emails.length?c.a.createElement("div",{className:"person-contact"},e.emails.map(function(e){return c.a.createElement("p",{className:"person-email",key:e},c.a.createElement("i",{className:"fa fa-envelope"}),c.a.createElement("a",{href:"mailto:"+e}," ",e," "))})):null}function B(e){if(!e.childCount)return null;var a=c.a.createElement("i",{className:"fa fa-baby"});return c.a.createElement("span",{className:"child-count"},e.childCount[0]?c.a.createElement("span",{title:"children"},c.a.createElement("strong",null,a," ",e.childCount[0]," ")):null,e.childCount[1]?c.a.createElement("span",{title:"grandchildren"},c.a.createElement("strong",null,a,a," ",e.childCount[1]," ")):null,e.childCount[2]?c.a.createElement("span",{title:"great grandchildren"},c.a.createElement("strong",null,a,a,a,"  ",e.childCount[2]," ")):null)}function F(e){return e&&e.date&&e.date.description&&e.date.date?c.a.createElement("div",{className:"person-date"},function(e){var a=e.toLowerCase();if(a.includes("birthday")||a.includes("bday")||a.includes("born"))return c.a.createElement("i",{title:e,className:"fa fa-birthday-cake"});if(a.includes("married")||a.includes("wedding")||a.includes("anniversary"))return c.a.createElement("i",{title:e,className:"fas fa-ring"})}(e.date.description)," ",function(e){e=v(e);var a=v().diff(e,"months");a<36?(t=a/12,a=Math.floor(10*t)/10):a=function(e){return Math.floor(e)}(a/12);var t;return"".concat(e.format("M/D/YYYY")," (").concat(a,")")}(e.date.date)):null}var _=t(21),A=t(22);function P(e){return c.a.createElement("div",{className:"news"},function(e){var a=[],t=!0,n=!1,l=void 0;try{for(var r,i=e[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var c=r.value,s=!0,o=!1,m=void 0;try{for(var u,d=c.dates[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var f=u.value,E=Number(v(f.date).format("DDD"));E<Number(v().format("DDD"))-30&&(E+=366),a.push({displayDate:v(f.date).format("MMMM D"),date:v(f.date),sortDate:E,description:f.description,name:c.name,id:c.id,imageId:c.imageId,blur:c.blur})}}catch(p){o=!0,m=p}finally{try{s||null==d.return||d.return()}finally{if(o)throw m}}}}catch(p){n=!0,l=p}finally{try{t||null==i.return||i.return()}finally{if(n)throw l}}return _.sortBy(a,[function(e){return e.sortDate}])}(e.family).map(function(e){return c.a.createElement(z,{item:e,key:e.id+"_"+e.date})}))}function z(e){var a=e.item;return c.a.createElement("div",{className:"news-item "+(a.blur?"blur":"")},c.a.createElement("div",{className:"columns is-mobile  is-vcentered"},c.a.createElement("div",{className:"column is-narrow"},c.a.createElement(L,{id:a.id,imageId:a.imageId})),c.a.createElement("div",{className:"column"},c.a.createElement("div",null,c.a.createElement("strong",null,a.displayDate)),c.a.createElement("div",null,c.a.createElement(A.HashLink,{to:"/Directory/#"+a.id},a.name)),c.a.createElement("div",null,a.description," ",c.a.createElement("strong",null,v().add(335,"days").diff(a.date,"years")),a.description.toLowerCase().includes("married")?" years":null))))}function J(e){var a=function(e){var a=[0,0,0,0,0],t=!0,n=!1,l=void 0;try{for(var r,i=e[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var c=r.value;H(c)?a[G(c.id)]+=2:a[G(c.id)]+=1}}catch(s){n=!0,l=s}finally{try{t||null==i.return||i.return()}finally{if(n)throw l}}return a}(e.family),t=a.reduce(function(e,a){return e+a});return c.a.createElement("div",{className:"stats"},c.a.createElement("dl",{className:"dl-horizontal"},a.map(function(e,a){return e>0?c.a.createElement(c.a.Fragment,{key:"gen_"+a},c.a.createElement("dt",null,"Generation ",a+1," ")," ",c.a.createElement("dd",null," ",e," ")," "):null}),c.a.createElement("dt",null,"Total"),c.a.createElement("dd",null,t)))}function G(e){return String(e).length-1}function H(e){if(e.dates&&e.dates.length){var a=!0,t=!1,n=void 0;try{for(var l,r=e.dates[Symbol.iterator]();!(a=(l=r.next()).done);a=!0){var i=l.value.description.toLowerCase();if(i.includes("married")||i.includes("anniversary")||i.includes("wedding"))return!0}}catch(c){t=!0,n=c}finally{try{a||null==r.return||r.return()}finally{if(t)throw n}}}return!1}function R(e){var a=Object(i.useState)(e.children),t=Object(n.a)(a,2),l=t[0],r=t[1];function s(){var a,t=function(e,a){var t=[],n=!0,l=!1,r=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){var s=i.value;document.getElementById(s)&&t.push({id:s,top:document.getElementById(s).offsetTop})}}catch(d){l=!0,r=d}finally{try{n||null==c.return||c.return()}finally{if(l)throw r}}t.sort(function(e,a){return e.pos-a.pos});for(var o=0,m=t;o<m.length;o++){var u=m[o];if(u.top>=a)return u.id}}(e.children.map(function(e){return e.props.id}),window.scrollY),n=[],l=!0,i=!1,s=void 0;try{for(var o,m=e.children[Symbol.iterator]();!(l=(o=m.next()).done);l=!0){var u=o.value;a=u.props.id===t,(q(t,u.props.id)||X(t,u.props.id)||K(t,u.props.id))&&n.push(c.a.cloneElement(u,{active:a}))}}catch(d){i=!0,s=d}finally{try{l||null==m.return||m.return()}finally{if(i)throw s}}return r(n),function(){window.onscroll=null}}return window.onscroll=s,Object(i.useEffect)(function(){return s()},[]),c.a.createElement("div",{className:"family-map"},l)}function q(e,a){for(;e>0;){if(a===e)return!0;e=Math.floor(e/10)}return!1}function X(e,a){return Math.floor(e/10)===Math.floor(a/10)}function K(e,a){return Math.floor(a/10)===e}function Q(e){return c.a.createElement("aside",{className:"navbar"},c.a.createElement(V,{onChange:e.search,term:e.term}),c.a.createElement(U,{expanded:e.expanded,toggleExpand:e.toggleExpand}),c.a.createElement(R,{items:e.family.map(function(e){return e.id.toString()}),currentClassName:"active"},e.family.map(function(e){return c.a.createElement(W,{name:e.name,id:e.id,key:e.id})})))}function U(e){var a=c.a.createElement("i",{className:"fa fa-expand-arrows-alt"}),t=c.a.createElement("i",{className:"fa fa-compress-arrows-alt"});return c.a.createElement(c.a.Fragment,null,e.expanded?c.a.createElement("button",{title:"collapse all",className:"button is-small is-fullwidth",onClick:e.toggleExpand}," ",t," \xa0 Collapse All"):c.a.createElement("button",{title:"expand all",className:"button is-small is-fullwidth",onClick:e.toggleExpand}," ",a," \xa0Expand All "))}function V(e){return c.a.createElement("input",{className:"searchbox input is-small",type:"search",placeholder:"search",value:e.term,onChange:function(a){return e.onChange(a.target.value)}})}function W(e){for(var a=0,t=e.id;t>9;t/=10)a++;return c.a.createElement("div",{className:(e.active?"active":"")+" gen-"+a},c.a.createElement("a",{href:"#"+e.id}," ",e.name))}t(38);function Z(e){var a=Object(i.useState)(null),t=Object(n.a)(a,2),l=t[0],r=t[1],m=Object(i.useState)(""),u=Object(n.a)(m,2),d=u[0],E=u[1],p=Object(i.useState)(null),v=Object(n.a)(p,2),h=v[0],g=v[1],b=Object(i.useState)(null),N=Object(n.a)(b,2),y=N[0],C=N[1],w=Object(i.useState)(!0),j=Object(n.a)(w,2),x=j[0],k=j[1];return Object(i.useEffect)(function(){f("/api/family").then(function(e){e&&(r(e),g(e))}),f("/api/name").then(function(e){e&&(C(e.title),document.title=e.title)})},[]),c.a.createElement(ae,null,c.a.createElement("h1",{className:"title is-3 has-text-centered has-text-primary"},c.a.createElement("a",{href:"/"},y)),c.a.createElement(s.BrowserRouter,null,c.a.createElement(c.a.Fragment,null,c.a.createElement($,{tabs:["Directory","News","Stats"]}),c.a.createElement("a",{href:"/logout",className:"logout"}," Logout "),h?c.a.createElement(o.g,null,c.a.createElement(o.d,{path:"/directory"},c.a.createElement("div",{className:"directory-container"},c.a.createElement(Q,{search:function(e){g(function(e,a){var t=!0,n=!1,l=void 0;try{for(var r,i=a[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var c=r.value;if(e){for(var s in c.blur=!0,c)if(c[s].toString().toLowerCase().includes(e.toLowerCase())&&(c.blur=!1),!c.blur)break}else c.blur=!1}}catch(o){n=!0,l=o}finally{try{t||null==i.return||i.return()}finally{if(n)throw l}}return a}(e,l)),E(e)},term:d,family:h,expanded:x,toggleExpand:function(){return k(!x)}}),c.a.createElement(S,{family:h,forceExpand:x,setFamily:r}))),c.a.createElement(o.d,{path:"/news"},c.a.createElement(P,{family:h})),c.a.createElement(o.d,{path:"/stats"},c.a.createElement(J,{family:h}))):c.a.createElement(ee,null))))}function $(e){return c.a.createElement("div",{className:"tabs is-centered"},c.a.createElement("ul",null,e.tabs.map(function(e){return c.a.createElement("li",{key:e,className:""},c.a.createElement(s.NavLink,{to:"/"+e,activeClassName:"is-active"},e))})))}function ee(e){return c.a.createElement("div",{className:"is-loading"}," Loading ... ")}function ae(e){return c.a.createElement("div",{className:"main"},e.children)}t.d(a,"default",function(){return Z}),r.a.render(c.a.createElement(Z,null),document.getElementById("root"))}},[[27,2,1]]]);
//# sourceMappingURL=main.5b682196.chunk.js.map